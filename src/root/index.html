<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Redirecting...</title>
    <script>
        const LANG_PREF_KEY = 'languagePreference';

        function getStoredLanguagePreference() {
            return localStorage.getItem(LANG_PREF_KEY);
        }

        function getRedirectPath() {
            // Default language is English
            const defaultLang = 'en';

            // Get the user's stored preference (if any)
            const storedPref = getStoredLanguagePreference();

            // Create the base URL, defaulting to English if no preference
            let redirectUrl = '/home/?lang=' + (storedPref || defaultLang);

            // If we have a stored preference and it's different from the default,
            // add the respectLangPref parameter so the language manager can handle it properly
            if (storedPref && storedPref !== defaultLang) {
                redirectUrl += '&respectLangPref';
            }

            return redirectUrl;
        }

        // Redirect to appropriate language version
        window.location.href = getRedirectPath();
    </script>
    <!-- Fallback meta redirect if JavaScript is disabled -->
    <meta http-equiv="refresh" content="0;url=/home/?lang=en" />
</head>
<body>
<p>Redirecting to appropriate language version...</p>
</body>
</html>